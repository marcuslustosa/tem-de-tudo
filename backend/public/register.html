<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cadastro - Tem de Tudo</title>
    
    <!-- Meta Tags PWA -->
    <meta name="description" content="Cadastre-se no Tem de Tudo e comece a acumular pontos e recompensas">
    <meta name="theme-color" content="#1e40af">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Cadastro - Tem de Tudo">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap" rel="stylesheet">
    
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <!-- Icons -->
    <link rel="icon" type="image/png" href="/frontend/img/logo.png">
    <link rel="apple-touch-icon" href="/frontend/img/logo.png">
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="/css/modern-theme.css">
    
    <!-- Manifest PWA -->
    <link rel="manifest" href="/manifest.json">
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="app-header">
            <div class="header-container">
                <a href="/" class="logo">
                    <img src="/frontend/img/logo.png" alt="Tem de Tudo" class="logo-image">
                </a>
                
                <nav class="nav-menu">
                    <a href="/"><i class="fas fa-home icon-sm"></i> Início</a>
                    <a href="/estabelecimentos.html"><i class="fas fa-store icon-sm"></i> Estabelecimentos</a>
                    <a href="/contato.html"><i class="fas fa-envelope icon-sm"></i> Contato</a>
                    <a href="/login.html"><i class="fas fa-sign-in-alt icon-sm"></i> Login</a>
                    <a href="/register.html" class="active"><i class="fas fa-user-plus icon-sm"></i> Cadastro</a>
                </nav>
                
                <button class="mobile-menu-btn" onclick="toggleMobileMenu()">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
            </div>
        </header>

        <!-- Mobile Navigation -->
        <div class="mobile-nav" id="mobileNav">
            <div class="mobile-nav-menu">
                <a href="/"><i class="fas fa-home icon-sm"></i> Início</a>
                <a href="/estabelecimentos.html"><i class="fas fa-store icon-sm"></i> Estabelecimentos</a>
                <a href="/contato.html"><i class="fas fa-envelope icon-sm"></i> Contato</a>
                <a href="/login.html"><i class="fas fa-sign-in-alt icon-sm"></i> Login</a>
                <a href="/register.html" class="active"><i class="fas fa-user-plus icon-sm"></i> Cadastro</a>
            </div>
        </div>

        <!-- Main Content -->
        <main class="app-main">
            <div class="container" style="max-width: 500px; margin: 2rem auto; padding: 0 1rem;">
                
                <!-- Welcome Bonus -->
                <div class="card mb-4">
                    <div class="card-header text-center">
                        <i class="fas fa-gift icon-lg" style="color: var(--accent-orange); font-size: 2rem; margin-bottom: 1rem;"></i>
                        <h3 style="color: white; margin-bottom: 0.5rem;">Bônus de Boas-vindas!</h3>
                        <p style="color: rgba(255,255,255,0.9);">Ganhe <strong>100 pontos</strong> ao criar sua conta</p>
                    </div>
                </div>

                <!-- Registration Form -->
                <div class="card">
                    <div class="card-header text-center">
                        <i class="fas fa-user-plus icon-lg" style="color: white; font-size: 2rem; margin-bottom: 1rem;"></i>
                        <h1 style="color: white; margin-bottom: 0.5rem;">Crie sua conta</h1>
                        <p style="color: rgba(255,255,255,0.9);">Junte-se ao nosso programa de fidelidade e comece a acumular pontos</p>
                    </div>

                    <form id="registerForm" class="card-body">
                        <div class="form-group">
                            <label for="nome" class="form-label">
                                <i class="fas fa-user icon-sm"></i> Nome Completo
                            </label>
                            <input 
                                type="text" 
                                id="nome" 
                                name="nome" 
                                class="form-control" 
                                placeholder="Seu nome completo" 
                                required
                            >
                        </div>

                        <div class="form-group">
                            <label for="telefone" class="form-label">
                                <i class="fas fa-phone icon-sm"></i> Telefone
                            </label>
                            <input 
                                type="tel" 
                                id="telefone" 
                                name="telefone" 
                                class="form-control" 
                                placeholder="(11) 99999-9999" 
                                required
                            >
                        </div>

                        <div class="form-group">
                            <label for="email" class="form-label">
                                <i class="fas fa-envelope icon-sm"></i> Email
                            </label>
                            <input 
                                type="email" 
                                id="email" 
                                name="email" 
                                class="form-control" 
                                placeholder="seu@email.com" 
                                required
                            >
                        </div>

                        <div class="form-group">
                            <label for="password" class="form-label">
                                <i class="fas fa-lock icon-sm"></i> Senha
                            </label>
                            <input 
                                type="password" 
                                id="password" 
                                name="password" 
                                class="form-control" 
                                placeholder="Crie uma senha forte" 
                                required
                                minlength="6"
                            >
                        </div>

                        <div class="form-group">
                            <label for="password_confirmation" class="form-label">
                                <i class="fas fa-lock icon-sm"></i> Confirmar Senha
                            </label>
                            <input 
                                type="password" 
                                id="password_confirmation" 
                                name="password_confirmation" 
                                class="form-control" 
                                placeholder="Confirme sua senha" 
                                required
                            >
                        </div>

                        <button type="submit" class="btn btn-primary w-full btn-lg">
                            <i class="fas fa-user-plus icon-sm"></i>
                            Criar minha conta grátis
                        </button>
                    </form>

                    <div class="card-footer text-center">
                        <p>Já tem uma conta? <a href="/login.html" style="color: var(--primary-blue); font-weight: 600;">Entre agora</a></p>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.7); display: none; z-index: 9999; align-items: center; justify-content: center;">
        <div style="text-align: center; color: white;">
            <div style="border: 3px solid var(--primary-blue); border-top: 3px solid transparent; border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; margin: 0 auto 1rem;"></div>
            <div>Carregando...</div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="/js/app-mobile.js"></script>
    <script>
        function toggleMobileMenu() {
            const mobileNav = document.getElementById('mobileNav');
            const btn = document.querySelector('.mobile-menu-btn');
            mobileNav.classList.toggle('active');
            btn.classList.toggle('active');
        }

        // Máscara para telefone
        document.addEventListener('DOMContentLoaded', function() {
            const telefoneInput = document.getElementById('telefone');
            if (telefoneInput) {
                telefoneInput.addEventListener('input', function() {
                    let value = this.value.replace(/\D/g, '');
                    if (value.length <= 11) {
                        value = value.replace(/(\d{2})(\d{5})(\d{4})/, '($1) $2-$3');
                        if (value.length < 14) {
                            value = value.replace(/(\d{2})(\d{4})(\d{0,4})/, '($1) $2-$3');
                        }
                        this.value = value;
                    }
                });
            }

            // Validação de confirmação de senha
            const passwordConfirm = document.getElementById('password_confirmation');
            const password = document.getElementById('password');
            
            if (passwordConfirm && password) {
                passwordConfirm.addEventListener('input', function() {
                    if (this.value !== password.value) {
                        this.setCustomValidity('As senhas não coincidem');
                        this.classList.add('error');
                    } else {
                        this.setCustomValidity('');
                        this.classList.remove('error');
                    }
                });

                password.addEventListener('input', function() {
                    if (passwordConfirm.value && passwordConfirm.value !== this.value) {
                        passwordConfirm.setCustomValidity('As senhas não coincidem');
                        passwordConfirm.classList.add('error');
                    } else {
                        passwordConfirm.setCustomValidity('');
                        passwordConfirm.classList.remove('error');
                    }
                });
            }

            // Submissão do formulário
            const registerForm = document.getElementById('registerForm');
            if (registerForm) {
                registerForm.addEventListener('submit', async function(e) {
                    e.preventDefault();
                    
                    const loadingOverlay = document.getElementById('loadingOverlay');
                    loadingOverlay.style.display = 'flex';

                    try {
                        const formData = new FormData(this);
                        const data = Object.fromEntries(formData);
                        
                        // Simulação de registro (substituir pela API real)
                        await new Promise(resolve => setTimeout(resolve, 2000));
                        
                        // Salvar dados do usuário
                        localStorage.setItem('user', JSON.stringify({
                            id: Date.now(),
                            nome: data.nome,
                            email: data.email,
                            telefone: data.telefone,
                            pontos: 100, // Bônus de boas-vindas
                            nivel: 'Bronze'
                        }));

                        alert('Conta criada com sucesso! Você ganhou 100 pontos de bônus!');
                        window.location.href = '/profile-client.html';
                        
                    } catch (error) {
                        console.error('Erro ao criar conta:', error);
                        alert('Erro ao criar conta. Tente novamente.');
                    } finally {
                        loadingOverlay.style.display = 'none';
                    }
                });
            }
        });
    </script>

    <style>
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .container {
            animation: fadeIn 0.6s ease forwards;
        }
    </style>
</body>
</html>
<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#6A0DAD">
    <title>Gerenciar UsuÃ¡rios - Admin</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="/css/vivo-global.css">
    <link rel="manifest" href="/manifest.json">
    <script src="/js/config.js"></script>
</head>
<body>
    <div class="admin-header">
        <div class="header-content">
            <h1><i class="fas fa-users-cog"></i> Gerenciar UsuÃ¡rios</h1>
            <button class="btn-secondary" onclick="history.back()" style="background:rgba(255,255,255,0.15);color:white;border:1px solid rgba(255,255,255,0.3);"><i class="fas fa-arrow-left"></i> Voltar</button>
        </div>
    </div>
    <div class="main">
        <div class="section">
            <div class="section-header">
                <div class="section-title">Todos os UsuÃ¡rios</div>
                <a href="/admin-criar-usuario.html" class="btn-primary" style="font-size:13px;padding:8px 14px;"><i class="fas fa-plus"></i> Novo</a>
            </div>
            <div class="search-box" style="margin-bottom:16px;">
                <i class="fas fa-search"></i>
                <input type="text" id="searchInput" placeholder="Buscar por nome, email ou CPF..." oninput="filterUsers(this.value)">
            </div>
            <div class="table-container">
                <table>
                    <thead><tr><th>Nome</th><th>Email</th><th>CPF</th><th>Perfil</th><th>Status</th><th>AÃ§Ãµes</th></tr></thead>
                    <tbody id="usersTable"><tr><td colspan="6" style="text-align:center;padding:40px;color:#86868b;">Carregando...</td></tr></tbody>
                </table>
            </div>
        </div>
    </div>
    <nav class="bottom-nav">
        <a href="/admin-painel.html" class="nav-item "><i class="fas fa-tachometer-alt"></i><span>Dashboard</span></a>
        <a href="/admin-usuarios.html" class="nav-item active"><i class="fas fa-users"></i><span>UsuÃ¡rios</span></a>
        <a href="/admin-empresas.html" class="nav-item "><i class="fas fa-building"></i><span>Empresas</span></a>
        <a href="/admin-relatorios.html" class="nav-item "><i class="fas fa-chart-line"></i><span>RelatÃ³rios</span></a>
        <a href="/admin-configuracoes.html" class="nav-item "><i class="fas fa-cog"></i><span>Config</span></a>
    </nav>
    <script>
        let allUsers = [];
        async function loadUsers() {
            try {
                const token = localStorage.getItem('token');
                if (!token) { window.location.href = '/admin-login.html'; return; }
                const r = await fetch(API_CONFIG.getBaseURL() + '/api/admin/users', { headers: { 'Authorization': 'Bearer ' + token, 'Accept': 'application/json' }});
                if (r.ok) { const j = await r.json(); allUsers = j.data || j || []; renderUsers(allUsers); }
                else if (r.status === 401) { window.location.href = '/admin-login.html'; }
            } catch(e) { console.error(e); renderUsers([]); }
        }
        function filterUsers(q) { renderUsers(allUsers.filter(u => (u.nome||u.name||'').toLowerCase().includes(q.toLowerCase()) || (u.email||'').toLowerCase().includes(q.toLowerCase()))); }
        function renderUsers(users) {
            const tbody = document.getElementById('usersTable');
            if (!users.length) { tbody.innerHTML = '<tr><td colspan="6" style="text-align:center;padding:40px;color:#86868b;">Nenhum usuÃ¡rio encontrado</td></tr>'; return; }
            tbody.innerHTML = users.map(u => <tr>
                <td></td><td></td><td></td>
                <td><span class="badge badge-info"></span></td>
                <td><span class="badge badge-"></span></td>
                <td style="display:flex;gap:6px;">
                    <button class="btn-secondary" style="font-size:12px;padding:6px 10px;" onclick="editUser()"><i class="fas fa-edit"></i></button>
                    <button class="btn-secondary" style="font-size:12px;padding:6px 10px;color:#ef4444;border-color:#fca5a5;" onclick="deleteUser()"><i class="fas fa-trash"></i></button>
                </td></tr>).join('');
        }
        function editUser(id) { alert('Editar usuÃ¡rio ' + id); }
        function deleteUser(id) { if(confirm('Excluir usuÃ¡rio?')) alert('ExcluÃ­do ' + id); }
        document.addEventListener('DOMContentLoaded', loadUsers);
    </script>
</body>
</html>






<!oDCTYPE html> <html lango="pto-oBR"> <head>     <meta charseto="UTFo-o8">     <meta nameo="viewprt" ocntento="width=deviceo-owidtho, initialo-oscale=1o.o0o, usero-oscalable=no">     <title>Criar Usuoáorio - Admin Tem de Tudo</otitle>     <meta nameo="descriptin" ocntento="Painel administrativpara criar nvos usuoáoris">
      <!o-o- VivPWA Meta -o->     <meta nameo="themeo-oclor" ocntento="#o6F1AB6">     <meta nameo="applicatino-oname" ocntento="Tem de TudAdmin">     <meta nameo="appleo-ombileo-owebo-oappo-ocapable" ocntento="yes">     <meta nameo="appleo-ombileo-owebo-oappo-ostatuso-obaro-ostyle" ocntento="default">     <meta nameo="appleo-ombileo-owebo-oappo-otitle" ocntento="Criar UsuoáoriAdmin">
      <!o-o- Icns -o->     <link relo="icn" otypeo="image/xo-oicn" ohrefo="/ofavicno.oico">
      <!o-o- VivCSS -o->     <link relo="stylesheet" ohrefo="/ocss/vivo-oappo-oficialo.ocss"> </ohead> <bdy classo="admino-opage">     <!o-o- VivHeader -o->     <header classo="vivo-oheader">         <div classo="cntainer">             <div classo="vivo-olgo">                 <div classo="temo-odeo-otudo-olgo small">
 Tem de<br>Tudo 
                </odiv>
 Criar Usuoáorio 
            </odiv>             <div classo="headero-oactins">                 <a hrefo="admino-odashbardo-ofuncinalo.ohtml" oclasso="btn btno-outline">                     <i classo="fas fao-oarrwo-oleft"></oi> oVltar 
                </oa>             </odiv>         </odiv>     </oheader>
     <!o-o- Main Cntent -o->     <main classo="maino-ocntent">         <div classo="cntainer">             <!o-o- HerSectin -o->             <div classo="hero-osectin">                 <h1 classo="hero-otitle">Criar Nvo Usuoáorio</oh1>                 <p classo="hero-osubtitle">Adicine um nvo usuoáoriao sistema</op>             </odiv>
             <!o-o- Messages -o->             <div ido="errrMessage" oclasso="message errro-omessage" ostyleo="displayo: nneo;"></odiv>             <div ido="successMessage" oclasso="message successo-omessage" ostyleo="displayo: nneo;"></odiv>
             <!o-o- User Type Selectin -o->             <div classo="card">                 <div classo="cardo-oheader">                     <h2 classo="cardo-otitle">Selecine Tipde Usuoáorio</oh2>                 </odiv>                 <div classo="cardo-obdy">                     <div classo="usero-otypeo-oselectin">                         <div classo="usero-otypeo-optin active" odatao-otypeo="cliente">                             <div classo="typeo-oicn">                                 <i classo="fas fao-ouser"></oi>                             </odiv>                             <h4>Cliente</oh4>                             <p>Usuoáorique acumula e resgata pnts</op>                             <ul classo="featureso-olist">                                 <li>Acoúomulde pnts</oli>                                 <li>Resgate de recmpensas</oli>                                 <li>Histoóoricde cmpras</oli>                                 <li>QR Cde pessal</oli>                             </oul>                         </odiv>
                         <div classo="usero-otypeo-optin" odatao-otypeo="empresa">                             <div classo="typeo-oicn">                                 <i classo="fas fao-obuilding"></oi>                             </odiv>                             <h4>Empresa</oh4>                             <p>Estabelecimentparceirdo sistema</op>                             <ul classo="featureso-olist">                                 <li>Gestde clientes</oli>                                 <li>Scanner de QR Cde</oli>                                 <li>Relatoóoris de vendas</oli>                                 <li>Cnfiguraoçode prmoçoõoes</oli>                             </oul>                         </odiv>                     </odiv>                 </odiv>             </odiv>
             <!o-o- User Frm -o->             <frm ido="createUserFrm" oclasso="spaceo-oyo-o4">                 <!o-o- Basic Infrmatin -o->                 <div classo="frmo-osectin">                     <h4>Infrmaoçoõoes Boáosicas</oh4>
                      <div classo="frmo-orw">                         <div classo="frmo-ogrup">                             <label fro="nme" oclasso="frmo-olabel">Nme Cmpleto *</olabel>                             <input typeo="text" oido="nme" onameo="nme" oclasso="frmo-oinput" orequired placehldero="Digite nme cmpleto">                         </odiv>                         <div classo="frmo-ogrup">                             <label fro="email" oclasso="frmo-olabel">Email *</olabel>                             <input typeo="email" oido="email" onameo="email" oclasso="frmo-oinput" orequired placehldero="emailo@oexemplo.ocm">                         </odiv>                     </odiv>
                     <div classo="frmo-orw">                         <div classo="frmo-ogrup">                             <label fro="telefne" oclasso="frmo-olabel">Telefne *</olabel>                             <input typeo="tel" oido="telefne" onameo="telefne" oclasso="frmo-oinput" orequired placehldero="(o11o) 99999o-o9999">                         </odiv>                         <div classo="frmo-ogrup">                             <label fro="cpfCnpj" oclasso="frmo-olabel">                                 <span ido="dcLabel">CPF</ospan> o* 
                            </olabel>                             <input typeo="text" oido="cpfCnpj" onameo="cpfCnpj" oclasso="frmo-oinput" orequired placehldero="000o.o000o.o000o-o00">                         </odiv>                     </odiv>                 </odiv>
                 <!o-o- Client Specific Fields -o->                 <div ido="clientFields" oclasso="frmo-osectin">                     <h4>Infrmaoçoõoes dCliente</oh4>
                      <div classo="frmo-orw">                         <div classo="frmo-ogrup">                             <label fro="enderec" oclasso="frmo-olabel">Endereoçoo *</olabel>                             <input typeo="text" oido="enderec" onameo="enderec" oclasso="frmo-oinput" oplacehldero="Endereoçocompleto">                         </odiv>                         <div classo="frmo-ogrup">                             <label fro="dataNasciment" oclasso="frmo-olabel">Data de Nascimento</olabel>                             <input typeo="date" oido="dataNasciment" onameo="dataNasciment" oclasso="frmo-oinput">                         </odiv>                     </odiv>                 </odiv>
                 <!o-o- Cmpany Specific Fields -o->                 <div ido="cmpanyFields" oclasso="frmo-osectin" ostyleo="displayo: nneo;">                     <h4>Infrmaoçoõoes da Empresa</oh4>
                      <div classo="frmo-orw">                         <div classo="frmo-ogrup">                             <label fro="nmeFantasia" oclasso="frmo-olabel">Nme Fantasia</olabel>                             <input typeo="text" oido="nmeFantasia" onameo="nmeFantasia" oclasso="frmo-oinput" oplacehldero="Nme fantasia da empresa">                         </odiv>                         <div classo="frmo-ogrup">                             <label fro="categria" oclasso="frmo-olabel">Categria *</olabel>                             <select ido="categria" onameo="categria" oclasso="frmo-oselect">                                 <optin valueo="">Selecine a categria</optin>                                 <optin valueo="alimentacao">Alimentaoçoo</optin>                                 <optin valueo="vestuario">Vestuoáorio</optin>                                 <optin valueo="saude">Saoúode</optin>                                 <optin valueo="beleza">Beleza</optin>                                 <optin valueo="tecnlogia">Tecnlogia</optin>                                 <optin valueo="servics">Servioços</optin>                                 <optin valueo="utrs">utrs</optin>                             </oselect>                         </odiv>                     </odiv>
                     <div classo="frmo-orw">                         <div classo="frmo-ogrup">                             <label fro="enderecEmpresa" oclasso="frmo-olabel">Endereoçoda Empresa *</olabel>                             <input typeo="text" oido="enderecEmpresa" onameo="enderecEmpresa" oclasso="frmo-oinput" oplacehldero="Endereoçoda empresa">                         </odiv>                         <div classo="frmo-ogrup">                             <label fro="pntPorReal" oclasso="frmo-olabel">Pnts pr Ro$</olabel>                             <input typeo="number" oido="pntPorReal" onameo="pntPorReal" oclasso="frmo-oinput" omino="1" ovalueo="1" oplacehldero="1">                         </odiv>                     </odiv>                 </odiv>
                 <!o-o- Passwrd Fields -o->                 <div classo="frmo-osectin">                     <h4>Credenciais de Acesso</oh4>
                      <div classo="frmo-orw">                         <div classo="frmo-ogrup">                             <label fro="senha" oclasso="frmo-olabel">Senha *</olabel>                             <div classo="passwrdo-ofield">                                 <input typeo="passwrd" oido="senha" onameo="senha" oclasso="frmo-oinput" orequired placehldero="Digite a senha">                                 <buttn typeo="buttn" oclasso="passwrdo-otggle" onclicko="tgglePasswrdo(o'osenhao'o)">                                     <i ido="senhaIcn" oclasso="fas fao-oeye"></oi>                                 </obuttn>                             </odiv>                         </odiv>                         <div classo="frmo-ogrup">                             <label fro="cnfirmarSenha" oclasso="frmo-olabel">Cnfirmar Senha *</olabel>                             <div classo="passwrdo-ofield">                                 <input typeo="passwrd" oido="cnfirmarSenha" onameo="cnfirmarSenha" oclasso="frmo-oinput" orequired placehldero="Cnfirme a senha">                                 <buttn typeo="buttn" oclasso="passwrdo-otggle" onclicko="tgglePasswrdo(o'ocnfirmarSenhao'o)">                                     <i ido="cnfirmarSenhaIcn" oclasso="fas fao-oeye"></oi>                                 </obuttn>                             </odiv>                         </odiv>                     </odiv>                 </odiv>
                 <!o-o- Frm Actins -o->                 <div classo="frmo-oactins">                     <buttn typeo="buttn" oclasso="btn btno-osecndary" onclicko="windwo.ohistryo.obacko(o)">                         <i classo="fas fao-otimes"></oi> oCancelar 
                    </obuttn>                     <buttn typeo="submit" oido="submitBtn" oclasso="btn btno-oprimary">                         <span ido="submitText">                             <i classo="fas fao-ousero-oplus"></oi> oCriar Cliente 
                        </ospan>                         <span ido="submitLading" oclasso="lading" ostyleo="displayo: nneo;">                             <i classo="fas fao-ospinner fao-ospin"></oi> oCriando.o.o. 
                        </ospan>                     </obuttn>                 </odiv>             </ofrm>         </odiv>     </omain>
     <!o-o- Scripts -o->     <script>
 let selectedUserTypeo = o'oclienteo'o; 
        // Select user type 
        ofunctin selectUserTypeo(otypeo) { 
            oselectedUserTypeo = otypeo; 
            // Update UI 
            odcumento.oquerySelectrAllo(o'o.ousero-otypeo-optino'o)o.ofrEacho(optin => o{ 
                optino.oclassListo.oremveo(o'oactiveo'o)o; 
            o}o)o; 
            odcumento.oquerySelectro(o`o[odatao-otypeo="$o{otypeo}"]o`o)o.oclassListo.oaddo(o'oactiveo'o)o; 
            // Shw/hide relevant fields 
            ocnst clientFieldso = odcumento.ogetElementByIdo(o'oclientFieldso'o)o; 
            ocnst cmpanyFieldso = odcumento.ogetElementByIdo(o'ocmpanyFieldso'o)o; 
            ocnst dcLabelo = odcumento.ogetElementByIdo(o'odcLabelo'o)o; 
            ocnst cpfCnpjo = odcumento.ogetElementByIdo(o'ocpfCnpjo'o)o; 
            ocnst submitTexto = odcumento.ogetElementByIdo(o'osubmitTexto'o)o; 
            oif (otypeo === o'oempresao'o) { 
                oclientFieldso.ostyleo.odisplayo = o'onneo'o; 
                ocmpanyFieldso.ostyleo.odisplayo = o'oblcko'o; 
                odcLabelo.otextCntento = o'oCNPJo'o; 
                ocpfCnpjo.oplacehldero = o'o00o.o000o.o000/0000o-o00o'o; 
                osubmitTexto.oinnerHTMLo = o'<i classo="fas fao-obuilding"></oi> oCriar Empresao'o; 
            o} else { 
                oclientFieldso.ostyleo.odisplayo = o'oblcko'o; 
                ocmpanyFieldso.ostyleo.odisplayo = o'onneo'o; 
                odcLabelo.otextCntento = o'oCPFo'o; 
                ocpfCnpjo.oplacehldero = o'o000o.o000o.o000o-o00o'o; 
                osubmitTexto.oinnerHTMLo = o'<i classo="fas fao-ousero-oplus"></oi> oCriar Clienteo'o; 
            o} 
        o} 
        // Tggle passwrd visibility 
        ofunctin tgglePasswrdo(ofieldIdo) { 
            ocnst inputo = odcumento.ogetElementByIdo(ofieldIdo)o; 
            ocnst icno = odcumento.ogetElementByIdo(ofieldId + 'oIcno'o)o; 
            oif (oinputo.otypeo === o'opasswrdo'o) { 
                oinputo.otypeo = o'otexto'o; 
                oicno.oclassNameo = o'ofas fao-oeyeo-oslasho'o; 
            o} else { 
                oinputo.otypeo = o'opasswrdo'o; 
                oicno.oclassNameo = o'ofas fao-oeyeo'o; 
            o} 
        o} 
        // Shw message 
        ofunctin shwMessageo(omessageo, typeo = o'oerrro'o) { 
            ocnst errrDivo = odcumento.ogetElementByIdo(o'oerrrMessageo'o)o; 
            ocnst successDivo = odcumento.ogetElementByIdo(o'osuccessMessageo'o)o; 
            // Hide all messages first 
            oerrrDivo.ostyleo.odisplayo = o'onneo'o; 
            osuccessDivo.ostyleo.odisplayo = o'onneo'o; 
            // Shw apprpriate message 
            oif (otypeo === o'oerrro'o) { 
                oerrrDivo.otextCntento = omessageo; 
                oerrrDivo.ostyleo.odisplayo = o'oblcko'o; 
            o} else { 
                osuccessDivo.otextCntento = omessageo; 
                osuccessDivo.ostyleo.odisplayo = o'oblcko'o; 
            o} 
        o} 
        // Validate frm 
        ofunctin validateFrmo(ofrmDatao) { 
            // Check passwrds match 
            oif (ofrmDatao.ogeto(o'osenhao'o) !== frmDatao.ogeto(o'ocnfirmarSenhao'o)o) { 
                othrw new Errro(o'oAs senhas ncoincidemo'o)o; 
            o} 
            // Validate CPF/CNPJ frmat (obasic validatino) 
            ocnst dco = ofrmDatao.ogeto(o'ocpfCnpjo'o)o; 
            oif (oselectedUserTypeo === o'oclienteo'o) { 
                oif (o!odco.omatcho(/^o\odo{o3o}o\o.o\odo{o3o}o\o.o\odo{o3o}o-o\odo{o2o}o$/)o) { 
                    othrw new Errro(o'oCPF deve estar nformat000o.o000o.o000o-o00o'o)o; 
                o} 
            o} else { 
                oif (o!odco.omatcho(/^o\odo{o2o}o\o.o\odo{o3o}o\o.o\odo{o3o}o\/\odo{o4o}o-o\odo{o2o}o$/)o) { 
                    othrw new Errro(o'oCNPJ deve estar nformat00o.o000o.o000/0000o-o00o'o)o; 
                o} 
            o} 
            // Validate email frmat 
            ocnst emailo = ofrmDatao.ogeto(o'oemailo'o)o; 
            oif (o!oemailo.oincludeso(o'o@o'o) |o| !oemailo.oincludeso(o'o.o'o)o) { 
                othrw new Errro(o'oEmail invoáolido'o)o; 
            o} 
            oreturn trueo; 
        o} 
        // Handle frm submissin 
        oasync functin handleCreateUsero(oevento) { 
            oevento.opreventDefaulto(o)o; 
            ocnst submitBtno = odcumento.ogetElementByIdo(o'osubmitBtno'o)o; 
            ocnst submitTexto = odcumento.ogetElementByIdo(o'osubmitTexto'o)o; 
            ocnst submitLadingo = odcumento.ogetElementByIdo(o'osubmitLadingo'o)o; 
            otry { 
                // Shw lading 
                osubmitBtno.odisabledo = otrueo; 
                osubmitTexto.ostyleo.odisplayo = o'onneo'o; 
                osubmitLadingo.ostyleo.odisplayo = o'oinlineo'o; 
                // Get frm data 
                ocnst frmDatao = onew FrmDatao(oevento.otargeto)o; 
                // Validate 
                ovalidateFrmo(ofrmDatao)o; 
                // Simulate API call (oreplace with real APIo) 
                ocnst respnseo = oawait fetcho(o'/api/admin/createo-ousero'o, { 
                    omethdo: 'oPSTo'o, 
                    obdyo: frmData 
                o}o)o; 
                oif (o!orespnseo.oko) { 
                    othrw new Errro(o'oErrao criar usuoáorio'o)o; 
                o} 
                // Success 
                ocnst userNameo = ofrmDatao.ogeto(o'onmeo'o)o; 
                ocnst userTypeTexto = oselectedUserTypeo === o'oclienteo' ? 'oClienteo' : 'oEmpresao'o; 
                oshwMessageo(o`o$o{ouserTypeTexto}o "$o{ouserNameo}" ocriadcom sucesso!o`o, 'osuccesso'o)o; 
                // Reset frm after success 
                oevento.otargeto.oreseto(o)o; 
                oselectUserTypeo(o'oclienteo'o)o;o // Reset tdefault 
            o} catch (oerrro) { 
                oshwMessageo(oerrro.omessageo, 'oerrro'o)o; 
            o} finally { 
                // Reset buttn 
                osubmitBtno.odisabledo = ofalseo; 
                osubmitTexto.ostyleo.odisplayo = o'oinlineo'o; 
                osubmitLadingo.ostyleo.odisplayo = o'onneo'o; 
            o} 
        o} 
        // Frmat CPF/CNPJ input 
        odcumento.ogetElementByIdo(o'ocpfCnpjo'o)o.oaddEventListenero(o'oinputo'o, functino(oeo) { 
            olet valueo = oeo.otargeto.ovalueo.oreplaceo(/\oD/go, 'o'o)o; 
            oif (oselectedUserTypeo === o'oclienteo'o) { 
                // CPF frmat 
                oif (ovalueo.olengtho <= 11o) { 
                    ovalueo = ovalueo.oreplaceo(/(o\odo{o3o}o)o(o\odo{o3o}o)o(o\odo{o3o}o)o(o\odo{o2o}o)/, 'o$o1o.o$o2o.o$o3o-o$o4o'o)o; 
                o} 
            o} else { 
                // CNPJ frmat 
                oif (ovalueo.olengtho <= 14o) { 
                    ovalueo = ovalueo.oreplaceo(/(o\odo{o2o}o)o(o\odo{o3o}o)o(o\odo{o3o}o)o(o\odo{o4o}o)o(o\odo{o2o}o)/, 'o$o1o.o$o2o.o$o3/$o4o-o$o5o'o)o; 
                o} 
            o} 
            oeo.otargeto.ovalueo = ovalueo; 
        o}o)o; 
        // Frmat phne input 
        odcumento.ogetElementByIdo(o'otelefneo'o)o.oaddEventListenero(o'oinputo'o, functino(oeo) { 
            olet valueo = oeo.otargeto.ovalueo.oreplaceo(/\oD/go, 'o'o)o; 
            oif (ovalueo.olengtho <= 11o) { 
                ovalueo = ovalueo.oreplaceo(/(o\odo{o2o}o)o(o\odo{o5o}o)o(o\odo{o4o}o)/, 'o(o$o1o) $o2o-o$o3o'o)o; 
            o} 
            oeo.otargeto.ovalueo = ovalueo; 
        o}o)o; 
        // User type selectin event listeners 
        odcumento.oquerySelectrAllo(o'o.ousero-otypeo-optino'o)o.ofrEacho(optin => o{ 
            optino.oaddEventListenero(o'oclicko'o, (o) => o{ 
                oselectUserTypeo(optino.odataseto.otypeo)o; 
            o}o)o; 
        o}o)o; 
        // Frm submit event 
        odcumento.ogetElementByIdo(o'ocreateUserFrmo'o)o.oaddEventListenero(o'osubmito'o, handleCreateUsero)o; 
        // Authenticatin check 
        ofunctin checkAutho(o) { 
            ocnst tkeno = olcalStrageo.ogetItemo(o'oauthTkeno'o)o; 
            ocnst userTypeo = olcalStrageo.ogetItemo(o'ouserTypeo'o)o; 
            oif (o!otken |o| userType !== 'oadmino'o) { 
                owindwo.olcatino.ohrefo = o'oadmino-olgino.ohtmlo'o; 
                oreturn falseo; 
            o} 
            oreturn trueo; 
        o} 
        // Initialize 
        odcumento.oaddEventListenero(o'oDMCntentLadedo'o, functino(o) { 
            oif (ocheckAutho(o)o) { 
                oselectUserTypeo(o'oclienteo'o)o;o // Set default 
            o} 
        o}o)o; 
    </oscript> </obdy> </ohtml>
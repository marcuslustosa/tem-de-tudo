<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Relatórios de Descontos - Admin</title>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap" rel="stylesheet">
    
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="/css/modern-theme.css">
    
    <style>
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }
        
        .metric-card {
            background: white;
            border-radius: var(--radius-xl);
            padding: 2rem;
            box-shadow: var(--shadow-soft);
            border: 1px solid var(--gray-200);
        }
        
        .metric-value {
            font-size: 2.5rem;
            font-weight: 800;
            margin-bottom: 0.5rem;
        }
        
        .metric-label {
            color: var(--gray-600);
            font-size: 0.875rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .metric-change {
            font-size: 0.875rem;
            margin-top: 0.5rem;
        }
        
        .metric-change.positive {
            color: var(--success-green);
        }
        
        .metric-change.negative {
            color: var(--error-red);
        }
        
        .chart-container {
            background: white;
            border-radius: var(--radius-xl);
            padding: 2rem;
            box-shadow: var(--shadow-soft);
            margin: 2rem 0;
        }
        
        .filters-bar {
            background: white;
            border-radius: var(--radius-xl);
            padding: 1.5rem;
            box-shadow: var(--shadow-soft);
            margin-bottom: 2rem;
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            align-items: center;
        }
        
        .table-container {
            background: white;
            border-radius: var(--radius-xl);
            overflow: hidden;
            box-shadow: var(--shadow-soft);
            margin: 2rem 0;
        }
        
        .data-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .data-table th {
            background: var(--gray-50);
            padding: 1rem;
            text-align: left;
            font-weight: 600;
            color: var(--gray-700);
            border-bottom: 1px solid var(--gray-200);
        }
        
        .data-table td {
            padding: 1rem;
            border-bottom: 1px solid var(--gray-100);
        }
        
        .data-table tr:hover {
            background: var(--gray-50);
        }
        
        .status-badge {
            padding: 0.25rem 0.75rem;
            border-radius: var(--radius-full);
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .status-active {
            background: var(--success-100);
            color: var(--success-700);
        }
        
        .status-used {
            background: var(--blue-100);
            color: var(--blue-700);
        }
        
        .status-expired {
            background: var(--gray-100);
            color: var(--gray-700);
        }
        
        .export-buttons {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Header Admin -->
        <header style="background: var(--primary-purple); color: white; padding: 1rem 2rem;">
            <div style="display: flex; justify-content: space-between; align-items: center; max-width: 1400px; margin: 0 auto;">
                <div>
                    <h2 style="margin: 0;"><i class="fas fa-chart-line"></i> Relatórios de Descontos</h2>
                    <p style="margin: 0; opacity: 0.8; font-size: 0.875rem;">Análise de performance e utilização</p>
                </div>
                <div style="text-align: right;">
                    <div style="font-size: 0.875rem; opacity: 0.8;">Empresa:</div>
                    <div style="font-weight: 600;">Restaurante Premium</div>
                </div>
            </div>
        </header>

        <main style="padding: 2rem; max-width: 1400px; margin: 0 auto;">
            
            <!-- Filtros -->
            <div class="filters-bar">
                <div style="flex: 1; min-width: 200px;">
                    <label class="form-label">Período:</label>
                    <select class="form-control" id="period-filter">
                        <option value="7">Últimos 7 dias</option>
                        <option value="30" selected>Últimos 30 dias</option>
                        <option value="90">Últimos 90 dias</option>
                        <option value="365">Último ano</option>
                        <option value="custom">Personalizado</option>
                    </select>
                </div>
                
                <div style="flex: 1; min-width: 200px;">
                    <label class="form-label">Nível de Desconto:</label>
                    <select class="form-control" id="level-filter">
                        <option value="all">Todos os níveis</option>
                        <option value="bronze">Bronze (5%)</option>
                        <option value="prata">Prata (10%)</option>
                        <option value="ouro">Ouro (15%)</option>
                        <option value="platina">Platina (20%)</option>
                    </select>
                </div>
                
                <div style="flex: 1; min-width: 200px;">
                    <label class="form-label">Status:</label>
                    <select class="form-control" id="status-filter">
                        <option value="all">Todos</option>
                        <option value="used">Utilizados</option>
                        <option value="active">Ativos</option>
                        <option value="expired">Expirados</option>
                    </select>
                </div>
                
                <div style="padding-top: 1.5rem;">
                    <button class="btn btn-primary" onclick="updateReports()">
                        <i class="fas fa-refresh"></i> Atualizar
                    </button>
                </div>
            </div>

            <!-- Métricas Principais -->
            <div class="metrics-grid">
                <div class="metric-card">
                    <div class="metric-value" style="color: var(--success-green);">R$ 12.450</div>
                    <div class="metric-label">Total em Descontos</div>
                    <div class="metric-change positive">
                        <i class="fas fa-arrow-up"></i> +15.2% vs mês anterior
                    </div>
                </div>
                
                <div class="metric-card">
                    <div class="metric-value" style="color: var(--blue-500);">847</div>
                    <div class="metric-label">Descontos Aplicados</div>
                    <div class="metric-change positive">
                        <i class="fas fa-arrow-up"></i> +8.7% vs mês anterior
                    </div>
                </div>
                
                <div class="metric-card">
                    <div class="metric-value" style="color: var(--primary-purple);">14.7%</div>
                    <div class="metric-label">Taxa de Utilização</div>
                    <div class="metric-change positive">
                        <i class="fas fa-arrow-up"></i> +2.3% vs mês anterior
                    </div>
                </div>
                
                <div class="metric-card">
                    <div class="metric-value" style="color: var(--orange-500);">R$ 14,70</div>
                    <div class="metric-label">Desconto Médio</div>
                    <div class="metric-change negative">
                        <i class="fas fa-arrow-down"></i> -3.1% vs mês anterior
                    </div>
                </div>
                
                <div class="metric-card">
                    <div class="metric-value" style="color: var(--teal-500);">324</div>
                    <div class="metric-label">Clientes Ativos</div>
                    <div class="metric-change positive">
                        <i class="fas fa-arrow-up"></i> +12.5% vs mês anterior
                    </div>
                </div>
                
                <div class="metric-card">
                    <div class="metric-value" style="color: var(--purple-500);">2.6x</div>
                    <div class="metric-label">ROI dos Descontos</div>
                    <div class="metric-change positive">
                        <i class="fas fa-arrow-up"></i> +0.3x vs mês anterior
                    </div>
                </div>
            </div>

            <!-- Gráficos -->
            <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 2rem; margin: 2rem 0;">
                <div class="chart-container">
                    <h4 style="margin-bottom: 2rem; color: var(--primary-purple);">
                        <i class="fas fa-chart-line"></i> Evolução dos Descontos
                    </h4>
                    <canvas id="discounts-chart" height="120"></canvas>
                </div>
                
                <div class="chart-container">
                    <h4 style="margin-bottom: 2rem; color: var(--primary-purple);">
                        <i class="fas fa-chart-pie"></i> Distribuição por Nível
                    </h4>
                    <canvas id="levels-chart"></canvas>
                </div>
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; margin: 2rem 0;">
                <div class="chart-container">
                    <h4 style="margin-bottom: 2rem; color: var(--primary-purple);">
                        <i class="fas fa-clock"></i> Horários de Maior Uso
                    </h4>
                    <canvas id="hours-chart" height="150"></canvas>
                </div>
                
                <div class="chart-container">
                    <h4 style="margin-bottom: 2rem; color: var(--primary-purple);">
                        <i class="fas fa-calendar"></i> Dias da Semana
                    </h4>
                    <canvas id="weekdays-chart" height="150"></canvas>
                </div>
            </div>

            <!-- Tabela de Transações Recentes -->
            <div class="table-container">
                <div style="padding: 2rem 2rem 1rem;">
                    <h4 style="margin: 0; color: var(--primary-purple);">
                        <i class="fas fa-history"></i> Transações Recentes
                    </h4>
                </div>
                
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Data/Hora</th>
                            <th>Cliente</th>
                            <th>Nível</th>
                            <th>Valor Original</th>
                            <th>Desconto</th>
                            <th>Valor Final</th>
                            <th>Pontos Gastos</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>15/12/2024 14:32</td>
                            <td>
                                <div style="font-weight: 600;">João Silva</div>
                                <div style="font-size: 0.875rem; color: var(--gray-600);">joao@email.com</div>
                            </td>
                            <td>
                                <span style="background: var(--gray-200); color: var(--gray-700); padding: 0.25rem 0.75rem; border-radius: var(--radius-md); font-size: 0.75rem; font-weight: 600;">
                                    PRATA 10%
                                </span>
                            </td>
                            <td>R$ 89,50</td>
                            <td style="color: var(--success-green); font-weight: 600;">- R$ 8,95</td>
                            <td style="font-weight: 600;">R$ 80,55</td>
                            <td>1.000 pts</td>
                            <td><span class="status-badge status-used">Usado</span></td>
                        </tr>
                        <tr>
                            <td>15/12/2024 12:15</td>
                            <td>
                                <div style="font-weight: 600;">Maria Santos</div>
                                <div style="font-size: 0.875rem; color: var(--gray-600);">maria@email.com</div>
                            </td>
                            <td>
                                <span style="background: var(--yellow-200); color: var(--yellow-700); padding: 0.25rem 0.75rem; border-radius: var(--radius-md); font-size: 0.75rem; font-weight: 600;">
                                    OURO 15%
                                </span>
                            </td>
                            <td>R$ 156,00</td>
                            <td style="color: var(--success-green); font-weight: 600;">- R$ 23,40</td>
                            <td style="font-weight: 600;">R$ 132,60</td>
                            <td>2.000 pts</td>
                            <td><span class="status-badge status-used">Usado</span></td>
                        </tr>
                        <tr>
                            <td>15/12/2024 10:45</td>
                            <td>
                                <div style="font-weight: 600;">Carlos Oliveira</div>
                                <div style="font-size: 0.875rem; color: var(--gray-600);">carlos@email.com</div>
                            </td>
                            <td>
                                <span style="background: var(--orange-200); color: var(--orange-700); padding: 0.25rem 0.75rem; border-radius: var(--radius-md); font-size: 0.75rem; font-weight: 600;">
                                    BRONZE 5%
                                </span>
                            </td>
                            <td>R$ 47,80</td>
                            <td style="color: var(--success-green); font-weight: 600;">- R$ 2,39</td>
                            <td style="font-weight: 600;">R$ 45,41</td>
                            <td>500 pts</td>
                            <td><span class="status-badge status-used">Usado</span></td>
                        </tr>
                        <tr>
                            <td>14/12/2024 19:22</td>
                            <td>
                                <div style="font-weight: 600;">Ana Costa</div>
                                <div style="font-size: 0.875rem; color: var(--gray-600);">ana@email.com</div>
                            </td>
                            <td>
                                <span style="background: var(--purple-200); color: var(--purple-700); padding: 0.25rem 0.75rem; border-radius: var(--radius-md); font-size: 0.75rem; font-weight: 600;">
                                    PLATINA 20%
                                </span>
                            </td>
                            <td>R$ 234,50</td>
                            <td style="color: var(--success-green); font-weight: 600;">- R$ 46,90</td>
                            <td style="font-weight: 600;">R$ 187,60</td>
                            <td>5.000 pts</td>
                            <td><span class="status-badge status-used">Usado</span></td>
                        </tr>
                        <tr>
                            <td>14/12/2024 16:08</td>
                            <td>
                                <div style="font-weight: 600;">Pedro Lima</div>
                                <div style="font-size: 0.875rem; color: var(--gray-600);">pedro@email.com</div>
                            </td>
                            <td>
                                <span style="background: var(--gray-200); color: var(--gray-700); padding: 0.25rem 0.75rem; border-radius: var(--radius-md); font-size: 0.75rem; font-weight: 600;">
                                    PRATA 10%
                                </span>
                            </td>
                            <td>R$ 67,30</td>
                            <td style="color: var(--success-green); font-weight: 600;">- R$ 6,73</td>
                            <td style="font-weight: 600;">R$ 60,57</td>
                            <td>1.000 pts</td>
                            <td><span class="status-badge status-used">Usado</span></td>
                        </tr>
                    </tbody>
                </table>
                
                <div style="padding: 1.5rem 2rem; text-align: center; border-top: 1px solid var(--gray-200);">
                    <button class="btn btn-outline">
                        <i class="fas fa-chevron-down"></i> Carregar Mais Transações
                    </button>
                </div>
            </div>

            <!-- Botões de Exportação -->
            <div class="export-buttons">
                <button class="btn btn-outline" onclick="exportReport('pdf')">
                    <i class="fas fa-file-pdf"></i> Exportar PDF
                </button>
                <button class="btn btn-outline" onclick="exportReport('excel')">
                    <i class="fas fa-file-excel"></i> Exportar Excel
                </button>
                <button class="btn btn-outline" onclick="exportReport('csv')">
                    <i class="fas fa-file-csv"></i> Exportar CSV
                </button>
                <div style="flex: 1;"></div>
                <button class="btn btn-primary" onclick="scheduledReport()">
                    <i class="fas fa-calendar-alt"></i> Agendar Relatório
                </button>
            </div>
        </main>
    </div>

    <script>
        // Inicialização dos Gráficos
        document.addEventListener('DOMContentLoaded', function() {
            initializeCharts();
        });

        function initializeCharts() {
            // Gráfico de Evolução
            const discountsCtx = document.getElementById('discounts-chart').getContext('2d');
            new Chart(discountsCtx, {
                type: 'line',
                data: {
                    labels: ['1 Dez', '5 Dez', '10 Dez', '15 Dez', '20 Dez', '25 Dez', '30 Dez'],
                    datasets: [{
                        label: 'Valor dos Descontos (R$)',
                        data: [320, 450, 680, 420, 890, 1200, 950],
                        borderColor: 'rgb(76, 29, 149)',
                        backgroundColor: 'rgba(76, 29, 149, 0.1)',
                        tension: 0.3,
                        fill: true
                    }, {
                        label: 'Quantidade de Descontos',
                        data: [25, 32, 48, 28, 61, 78, 65],
                        borderColor: 'rgb(34, 197, 94)',
                        backgroundColor: 'rgba(34, 197, 94, 0.1)',
                        tension: 0.3,
                        yAxisID: 'y1'
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            type: 'linear',
                            display: true,
                            position: 'left',
                        },
                        y1: {
                            type: 'linear',
                            display: true,
                            position: 'right',
                            grid: {
                                drawOnChartArea: false,
                            },
                        }
                    }
                }
            });

            // Gráfico de Distribuição por Nível
            const levelsCtx = document.getElementById('levels-chart').getContext('2d');
            new Chart(levelsCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Bronze', 'Prata', 'Ouro', 'Platina'],
                    datasets: [{
                        data: [35, 40, 20, 5],
                        backgroundColor: [
                            '#f97316',
                            '#6b7280',
                            '#eab308',
                            '#8b5cf6'
                        ],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });

            // Gráfico de Horários
            const hoursCtx = document.getElementById('hours-chart').getContext('2d');
            new Chart(hoursCtx, {
                type: 'bar',
                data: {
                    labels: ['8h', '10h', '12h', '14h', '16h', '18h', '20h', '22h'],
                    datasets: [{
                        label: 'Descontos por Horário',
                        data: [12, 28, 65, 45, 32, 78, 89, 34],
                        backgroundColor: 'rgba(76, 29, 149, 0.8)'
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });

            // Gráfico de Dias da Semana
            const weekdaysCtx = document.getElementById('weekdays-chart').getContext('2d');
            new Chart(weekdaysCtx, {
                type: 'radar',
                data: {
                    labels: ['Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sáb', 'Dom'],
                    datasets: [{
                        label: 'Uso por Dia da Semana',
                        data: [65, 72, 68, 85, 92, 78, 45],
                        backgroundColor: 'rgba(34, 197, 94, 0.2)',
                        borderColor: 'rgb(34, 197, 94)',
                        pointBackgroundColor: 'rgb(34, 197, 94)'
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        r: {
                            beginAtZero: true,
                            max: 100
                        }
                    }
                }
            });
        }

        function updateReports() {
            // Simular atualização dos dados
            console.log('Atualizando relatórios...');
            // Aqui você faria a chamada para a API real
        }

        function exportReport(format) {
            alert(`Exportando relatório em formato ${format.toUpperCase()}...`);
            // Aqui você implementaria a exportação real
        }

        function scheduledReport() {
            alert('Abrindo configurações de relatório agendado...');
            // Aqui você abriria um modal para configurar relatórios automáticos
        }
    </script>
</body>
</html>
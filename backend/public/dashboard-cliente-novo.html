<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dashboard Cliente - Tem de Tudo</title>
<meta name="description" content="Painel do cliente Tem de Tudo - Gerencie pontos, pedidos e explore ofertas">
<meta name="theme-color" content="#6F1AB6">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
<script src="js/config.js"></script>
<script src="js/auth-guard.js"></script>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
<link rel="stylesheet" href="css/vivo-styles.css">
<script src="js/config.js"></script>
<script src="js/auth-guard.js"></script>
</head>
<body>
<!-- HEADER -->
<div class="header">
    <div class="header-top">
        <div class="logo">
            <i class="fas fa-shopping-bag"></i> Tem de Tudo
        </div>
        <button class="logout-btn" onclick="logout()">
            <i class="fas fa-sign-out-alt"></i>
            Sair
        </button>
    </div>
    <div class="welcome">
        <h1 id="welcomeText">Olá, Cliente!</h1>
        <p>Bem-vindo ao seu painel pessoal</p>
    </div>
</div>

<!-- CONTAINER PRINCIPAL -->
<div class="container">
    <!-- CARD DE PONTOS -->
    <div class="points-card">
        <div class="points-title">
            <i class="fas fa-star"></i>
            Seus Pontos Tem de Tudo
        </div>
        <div class="points-value" id="pointsValue">180</div>
        <div class="points-label">pontos disponíveis</div>
        <div class="points-actions">
            <a href="app-meu-qrcode.html" class="btn btn-white">
                <i class="fas fa-qrcode"></i>
                Meu QR Code
            </a>
            <a href="app-promocoes.html" class="btn btn-outline">
                <i class="fas fa-gift"></i>
                Ver Promoções
            </a>
        </div>
    </div>

    <!-- ESTATÍSTICAS -->
    <div class="stats">
        <div class="stat-card">
            <div class="stat-icon">
                <i class="fas fa-shopping-bag"></i>
            </div>
            <div class="stat-value">15</div>
            <div class="stat-label">Compras Realizadas</div>
        </div>
        <div class="stat-card">
            <div class="stat-icon" style="background: var(--vivo-green);">
                <i class="fas fa-dollar-sign"></i>
            </div>
            <div class="stat-value">R$ 890</div>
            <div class="stat-label">Total Economizado</div>
        </div>
        <div class="stat-card">
            <div class="stat-icon" style="background: var(--vivo-orange);">
                <i class="fas fa-store"></i>
            </div>
            <div class="stat-value">5</div>
            <div class="stat-label">Empresas Diferentes</div>
        </div>
        <div class="stat-card">
            <div class="stat-icon" style="background: var(--vivo-blue);">
                <i class="fas fa-crown"></i>
            </div>
            <div class="stat-value">Gold</div>
            <div class="stat-label">Seu Nível</div>
        </div>
    </div>

    <!-- AÇÕES RÁPIDAS -->
    <div class="section">
        <h2 class="section-title">
            <i class="fas fa-rocket"></i>
            Ações Rápidas
        </h2>
        <div class="actions-grid">
            <a href="app-empresas.html" class="action-card">
                <div class="action-icon">
                    <i class="fas fa-search"></i>
                </div>
                <div class="action-content">
                    <h3>Explorar Empresas</h3>
                    <p>Descubra empresas parceiras próximas a você</p>
                </div>
            </a>

            <a href="app-promocoes.html" class="action-card">
                <div class="action-icon" style="background: var(--vivo-green);">
                    <i class="fas fa-percent"></i>
                </div>
                <div class="action-content">
                    <h3>Ver Promoções</h3>
                    <p>Ofertas exclusivas disponíveis agora</p>
                </div>
            </a>

            <a href="app-meu-qrcode.html" class="action-card">
                <div class="action-icon" style="background: var(--vivo-orange);">
                    <i class="fas fa-qrcode"></i>
                </div>
                <div class="action-content">
                    <h3>Meu QR Code</h3>
                    <p>Mostre na loja para acumular pontos</p>
                </div>
            </a>

            <a href="app-extrato.html" class="action-card">
                <div class="action-icon" style="background: var(--vivo-blue);">
                    <i class="fas fa-history"></i>
                </div>
                <div class="action-content">
                    <h3>Histórico</h3>
                    <p>Veja suas compras e pontos acumulados</p>
                </div>
            </a>
        </div>
    </div>

    <!-- OFERTAS EM DESTAQUE -->
    <div class="section">
        <h2 class="section-title">
            <i class="fas fa-fire"></i>
            Ofertas Imperdíveis
        </h2>
        <div class="offers-grid">
            <div class="offer-card">
                <div class="offer-image">
                    <i class="fas fa-utensils"></i>
                </div>
                <div class="offer-content">
                    <h3 class="offer-title">10% OFF Almoço</h3>
                    <p class="offer-description">Desconto especial no Restaurante Sabor da Casa</p>
                    <div class="offer-price">Precisa: 50 pontos</div>
                    <button class="btn-offer" onclick="usePromotion('rest1')">Usar Promoção</button>
                </div>
            </div>

            <div class="offer-card">
                <div class="offer-image" style="background: linear-gradient(135deg, var(--vivo-green) 0%, #059669 100%);">
                    <i class="fas fa-pills"></i>
                </div>
                <div class="offer-content">
                    <h3 class="offer-title">R$ 5 OFF Medicamentos</h3>
                    <p class="offer-description">Desconto na Farmácia São João</p>
                    <div class="offer-price">Precisa: 25 pontos</div>
                    <button class="btn-offer" onclick="usePromotion('farm1')">Usar Promoção</button>
                </div>
            </div>

            <div class="offer-card">
                <div class="offer-image" style="background: linear-gradient(135deg, var(--vivo-blue) 0%, #1d4ed8 100%);">
                    <i class="fas fa-gas-pump"></i>
                </div>
                <div class="offer-content">
                    <h3 class="offer-title">5% OFF Combustível</h3>
                    <p class="offer-description">Desconto no Posto Energia</p>
                    <div class="offer-price">Precisa: 100 pontos</div>
                    <button class="btn-offer" onclick="usePromotion('gas1')">Usar Promoção</button>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
// Carregamento inicial
window.addEventListener('DOMContentLoaded', function() {
    initializeDashboard();
});

function initializeDashboard() {
    loadUserData();
    loadUserPoints();
}

function loadUserData() {
    const userData = JSON.parse(localStorage.getItem('userData') || '{}');
    if (userData.name) {
        document.getElementById('welcomeText').textContent = `Olá, ${userData.name}!`;
    }
}

function loadUserPoints() {
    const userData = JSON.parse(localStorage.getItem('userData') || '{}');
    const points = userData.pontos || 180; // Fallback para Maria com 180 pontos
    document.getElementById('pointsValue').textContent = points;
}

function logout() {
    if (confirm('Tem certeza que deseja sair?')) {
        localStorage.clear();
        sessionStorage.clear();
        window.location.href = 'entrar.html';
    }
}

function usePromotion(promoId) {
    const userData = JSON.parse(localStorage.getItem('userData') || '{}');
    const currentPoints = userData.pontos || 180;
    
    // Definir pontos necessários para cada promoção
    const promotions = {
        'rest1': { name: '10% OFF Almoço', points: 50 },
        'farm1': { name: 'R$ 5 OFF Medicamentos', points: 25 },
        'gas1': { name: '5% OFF Combustível', points: 100 }
    };
    
    const promo = promotions[promoId];
    if (!promo) return;
    
    if (currentPoints >= promo.points) {
        if (confirm(`Usar ${promo.points} pontos para "${promo.name}"?`)) {
            // Atualizar pontos
            userData.pontos = currentPoints - promo.points;
            localStorage.setItem('userData', JSON.stringify(userData));
            
            // Atualizar display
            document.getElementById('pointsValue').textContent = userData.pontos;
            
            alert(`🎉 Promoção "${promo.name}" ativada com sucesso! Você agora tem ${userData.pontos} pontos.`);
        }
    } else {
        alert(`❌ Você precisa de ${promo.points} pontos para usar esta promoção. Você tem apenas ${currentPoints} pontos.`);
    }
}
</script>
</body>
</html>

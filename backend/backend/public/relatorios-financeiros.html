<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Relatórios Financeiros - Tem de Tudo</title>
    
    <!-- Meta Tags PWA -->
    <meta name="description" content="Relatórios financeiros e de pagamentos via Mercado Pago">
    <meta name="theme-color" content="#2563eb">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap" rel="stylesheet">
    
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Icons -->
    <link rel="icon" type="image/png" href="/frontend/img/logo.png">
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="/css/modern-theme.css">
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="app-header">
            <div class="header-container">
                <a href="/" class="logo">
                    <img src="/frontend/img/logo.png" alt="Tem de Tudo" class="logo-image">
                </a>
                
                <nav class="nav-menu">
                    <a href="/profile-company.html"><i class="fas fa-arrow-left icon-sm"></i> Voltar</a>
                    <a href="/profile-company.html"><i class="fas fa-building icon-sm"></i> Painel</a>
                    <a href="/admin.html"><i class="fas fa-tachometer-alt icon-sm"></i> Admin</a>
                </nav>
                
                <button class="mobile-menu-btn" onclick="toggleMobileMenu()">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
            </div>
        </header>

        <!-- Main Content -->
        <main class="app-main">
            <div style="max-width: 1400px; margin: 0 auto; padding: var(--space-6);">
                
                <!-- Header Card -->
                <div class="card mb-4">
                    <div class="card-header text-center">
                        <i class="fas fa-chart-line icon-lg" style="color: white; font-size: 3rem; margin-bottom: 1rem;"></i>
                        <h1 style="color: white; margin-bottom: 0.5rem;">Relatórios Financeiros</h1>
                        <p style="color: rgba(255,255,255,0.9);">Acompanhe seus ganhos e pagamentos via Mercado Pago</p>
                    </div>
                </div>

                <!-- Filtros -->
                <div class="card mb-4">
                    <div class="card-body">
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: var(--space-4); align-items: end;">
                            
                            <div class="form-group">
                                <label class="form-label">Período</label>
                                <select id="periodFilter" class="form-control" onchange="updateReports()">
                                    <option value="7">Últimos 7 dias</option>
                                    <option value="30" selected>Últimos 30 dias</option>
                                    <option value="90">Últimos 3 meses</option>
                                    <option value="365">Último ano</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Status</label>
                                <select id="statusFilter" class="form-control" onchange="updateReports()">
                                    <option value="all">Todos</option>
                                    <option value="approved">Aprovados</option>
                                    <option value="pending">Pendentes</option>
                                    <option value="cancelled">Cancelados</option>
                                </select>
                            </div>

                            <button class="btn btn-primary" onclick="exportReport()">
                                <i class="fas fa-download"></i> Exportar Relatório
                            </button>
                        </div>
                    </div>
                </div>

                <!-- KPIs Financeiros -->
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: var(--space-4); margin-bottom: var(--space-6);">
                    
                    <div class="card kpi-card">
                        <div class="card-body text-center">
                            <div class="kpi-icon" style="background: var(--success-green);">
                                <i class="fas fa-money-bill-wave"></i>
                            </div>
                            <h3 style="color: var(--gray-900); margin: 0.5rem 0;" id="totalRevenue">R$ 12.847,50</h3>
                            <p style="color: var(--gray-600); margin: 0; font-size: 0.875rem;">Receita Total</p>
                            <div style="margin-top: 0.5rem;">
                                <span style="color: var(--success-green); font-size: 0.875rem;">
                                    <i class="fas fa-arrow-up"></i> +18.5%
                                </span>
                            </div>
                        </div>
                    </div>

                    <div class="card kpi-card">
                        <div class="card-body text-center">
                            <div class="kpi-icon" style="background: var(--primary-blue);">
                                <i class="fas fa-credit-card"></i>
                            </div>
                            <h3 style="color: var(--gray-900); margin: 0.5rem 0;" id="totalTransactions">847</h3>
                            <p style="color: var(--gray-600); margin: 0; font-size: 0.875rem;">Transações</p>
                            <div style="margin-top: 0.5rem;">
                                <span style="color: var(--success-green); font-size: 0.875rem;">
                                    <i class="fas fa-arrow-up"></i> +12.3%
                                </span>
                            </div>
                        </div>
                    </div>

                    <div class="card kpi-card">
                        <div class="card-body text-center">
                            <div class="kpi-icon" style="background: var(--accent-orange);">
                                <i class="fas fa-calculator"></i>
                            </div>
                            <h3 style="color: var(--gray-900); margin: 0.5rem 0;" id="averageTicket">R$ 15,17</h3>
                            <p style="color: var(--gray-600); margin: 0; font-size: 0.875rem;">Ticket Médio</p>
                            <div style="margin-top: 0.5rem;">
                                <span style="color: var(--success-green); font-size: 0.875rem;">
                                    <i class="fas fa-arrow-up"></i> +5.2%
                                </span>
                            </div>
                        </div>
                    </div>

                    <div class="card kpi-card">
                        <div class="card-body text-center">
                            <div class="kpi-icon" style="background: var(--warning-yellow);">
                                <i class="fas fa-hourglass-half"></i>
                            </div>
                            <h3 style="color: var(--gray-900); margin: 0.5rem 0;" id="pendingPayments">R$ 234,80</h3>
                            <p style="color: var(--gray-600); margin: 0; font-size: 0.875rem;">Pendente</p>
                            <div style="margin-top: 0.5rem;">
                                <span style="color: var(--gray-600); font-size: 0.875rem;">
                                    3 transações
                                </span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Gráficos -->
                <div style="display: grid; grid-template-columns: 2fr 1fr; gap: var(--space-6); margin-bottom: var(--space-6);">
                    
                    <!-- Revenue Chart -->
                    <div class="card">
                        <div class="card-header">
                            <h3 style="color: white; margin: 0;">
                                <i class="fas fa-chart-area"></i> Evolução da Receita
                            </h3>
                        </div>
                        <div class="card-body">
                            <canvas id="revenueChart" style="max-height: 300px;"></canvas>
                        </div>
                    </div>

                    <!-- Payment Methods -->
                    <div class="card">
                        <div class="card-header">
                            <h3 style="color: white; margin: 0;">
                                <i class="fas fa-chart-pie"></i> Formas de Pagamento
                            </h3>
                        </div>
                        <div class="card-body">
                            <canvas id="paymentMethodsChart" style="max-height: 300px;"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Tabela de Transações -->
                <div class="card">
                    <div class="card-header">
                        <h3 style="color: white; margin: 0;">
                            <i class="fas fa-list"></i> Transações Recentes
                        </h3>
                    </div>
                    <div class="card-body" style="padding: 0;">
                        <div style="overflow-x: auto;">
                            <table style="width: 100%; border-collapse: collapse;">
                                <thead>
                                    <tr style="background: var(--gray-100);">
                                        <th style="padding: var(--space-3); text-align: left; font-weight: 600;">Data/Hora</th>
                                        <th style="padding: var(--space-3); text-align: left; font-weight: 600;">Cliente</th>
                                        <th style="padding: var(--space-3); text-align: left; font-weight: 600;">Valor</th>
                                        <th style="padding: var(--space-3); text-align: left; font-weight: 600;">Método</th>
                                        <th style="padding: var(--space-3); text-align: left; font-weight: 600;">Status</th>
                                        <th style="padding: var(--space-3); text-align: left; font-weight: 600;">Ações</th>
                                    </tr>
                                </thead>
                                <tbody id="transactionsTable">
                                    <!-- Transactions will be loaded here -->
                                </tbody>
                            </table>
                        </div>
                        
                        <div style="padding: var(--space-4); text-align: center; border-top: 1px solid var(--gray-200);">
                            <button class="btn btn-ghost" onclick="loadMoreTransactions()">
                                <i class="fas fa-plus"></i> Carregar Mais Transações
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        function toggleMobileMenu() {
            const mobileNav = document.getElementById('mobileNav');
            const btn = document.querySelector('.mobile-menu-btn');
            mobileNav?.classList.toggle('active');
            btn?.classList.toggle('active');
        }

        let revenueChart, paymentMethodsChart;

        document.addEventListener('DOMContentLoaded', function() {
            initializeCharts();
            loadTransactions();
            updateReports();
        });

        function initializeCharts() {
            // Revenue Chart
            const revenueCtx = document.getElementById('revenueChart').getContext('2d');
            revenueChart = new Chart(revenueCtx, {
                type: 'line',
                data: {
                    labels: ['1 Ago', '8 Ago', '15 Ago', '22 Ago', '29 Ago', '5 Set', '12 Set', '19 Set'],
                    datasets: [{
                        label: 'Receita (R$)',
                        data: [1200, 1890, 2100, 1750, 2400, 2890, 3200, 3647],
                        borderColor: '#10b981',
                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: { display: false }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return 'R$ ' + value.toLocaleString('pt-BR');
                                }
                            }
                        }
                    }
                }
            });

            // Payment Methods Chart
            const paymentCtx = document.getElementById('paymentMethodsChart').getContext('2d');
            paymentMethodsChart = new Chart(paymentCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Mercado Pago', 'PIX', 'Cartão Crédito', 'Cartão Débito'],
                    datasets: [{
                        data: [45, 30, 15, 10],
                        backgroundColor: [
                            '#2563eb',
                            '#10b981', 
                            '#f59e0b',
                            '#ef4444'
                        ],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 15,
                                usePointStyle: true
                            }
                        }
                    }
                }
            });
        }

        function loadTransactions() {
            const transactions = [
                {
                    date: '24/09/2025 14:32',
                    client: 'João Silva',
                    amount: 'R$ 89,50',
                    method: 'Mercado Pago',
                    status: 'approved',
                    id: 'MP001'
                },
                {
                    date: '24/09/2025 12:15',
                    client: 'Maria Santos',
                    amount: 'R$ 156,80',
                    method: 'PIX',
                    status: 'approved',
                    id: 'PIX002'
                },
                {
                    date: '23/09/2025 16:45',
                    client: 'Pedro Costa',
                    amount: 'R$ 73,25',
                    method: 'Cartão Crédito',
                    status: 'pending',
                    id: 'CC003'
                },
                {
                    date: '23/09/2025 11:20',
                    client: 'Ana Oliveira',
                    amount: 'R$ 234,90',
                    method: 'Mercado Pago',
                    status: 'approved',
                    id: 'MP004'
                },
                {
                    date: '22/09/2025 09:30',
                    client: 'Carlos Ferreira',
                    amount: 'R$ 45,60',
                    method: 'PIX',
                    status: 'cancelled',
                    id: 'PIX005'
                }
            ];

            const tbody = document.getElementById('transactionsTable');
            tbody.innerHTML = '';

            transactions.forEach(transaction => {
                const row = document.createElement('tr');
                row.style.borderBottom = '1px solid var(--gray-200)';
                
                const statusColors = {
                    approved: 'var(--success-green)',
                    pending: 'var(--warning-yellow)', 
                    cancelled: 'var(--error-red)'
                };

                const statusLabels = {
                    approved: '✅ Aprovado',
                    pending: '⏳ Pendente',
                    cancelled: '❌ Cancelado'
                };

                row.innerHTML = `
                    <td style="padding: var(--space-3);">${transaction.date}</td>
                    <td style="padding: var(--space-3); font-weight: 600;">${transaction.client}</td>
                    <td style="padding: var(--space-3); font-weight: 600; color: var(--success-green);">${transaction.amount}</td>
                    <td style="padding: var(--space-3);">${transaction.method}</td>
                    <td style="padding: var(--space-3); color: ${statusColors[transaction.status]};">${statusLabels[transaction.status]}</td>
                    <td style="padding: var(--space-3);">
                        <button class="btn btn-ghost btn-sm" onclick="viewTransaction('${transaction.id}')">
                            <i class="fas fa-eye"></i>
                        </button>
                    </td>
                `;
                
                tbody.appendChild(row);
            });
        }

        function updateReports() {
            // Simular atualização baseada nos filtros
            console.log('Atualizando relatórios...');
        }

        function exportReport() {
            const period = document.getElementById('periodFilter').value;
            const status = document.getElementById('statusFilter').value;
            
            alert(`📊 Exportando Relatório Financeiro\n\nPeríodo: ${period} dias\nStatus: ${status}\n\nO arquivo Excel será enviado para seu email em alguns minutos.\n\nConteúdo:\n• Todas as transações\n• Gráficos de receita\n• Análise de métodos de pagamento\n• KPIs financeiros`);
        }

        function loadMoreTransactions() {
            alert('Carregando mais transações...\n\nFuncionalidade em desenvolvimento!');
        }

        function viewTransaction(transactionId) {
            alert(`📄 Detalhes da Transação: ${transactionId}\n\nEm breve você poderá:\n• Ver dados completos\n• Comprovantes\n• Histórico de status\n• Detalhes do cliente\n• Reembolsar se necessário`);
        }
    </script>

    <style>
        .kpi-card .card-body {
            padding: var(--space-4);
        }

        .kpi-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
            margin: 0 auto 1rem;
        }

        table th {
            background: var(--gray-100);
            position: sticky;
            top: 0;
        }

        @media (max-width: 768px) {
            div[style*="grid-template-columns: 2fr 1fr"] {
                grid-template-columns: 1fr !important;
            }
            
            .kpi-icon {
                width: 50px;
                height: 50px;
                font-size: 1.25rem;
            }
            
            table {
                font-size: 0.875rem;
            }
        }
    </style>
</body>
</html>
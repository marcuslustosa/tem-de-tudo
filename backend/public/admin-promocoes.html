<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Gerenciar Promoções - Admin Tem de Tudo</title>
<meta name="description" content="Painel administrativo para gerenciar promoções e campanhas">
<meta name="theme-color" content="#6F1AB6">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
<link rel="stylesheet" href="css/vivo-styles.css">
<script src="js/config.js"></script>
<script src="js/auth-guard.js"></script>
</head>
</head>
<body>
<!-- HEADER -->
<div class="header">
    <div class="header-top">
        <h1 class="page-title">
            <i class="fas fa-tags"></i>
            Gerenciar Promoções
        </h1>
        <a href="admin-dashboard.html" class="back-btn">
            <i class="fas fa-arrow-left"></i>
            Voltar
        </a>
    </div>
</div>

<!-- CONTAINER PRINCIPAL -->
<div class="container">
    <!-- ESTATÍSTICAS -->
    <div class="stats">
        <div class="stat-card">
            <div class="stat-icon">
                <i class="fas fa-tags"></i>
            </div>
            <div class="stat-value" id="totalPromotions">24</div>
            <div class="stat-label">Total de Promoções</div>
        </div>
        <div class="stat-card">
            <div class="stat-icon" style="background: var(--vivo-green);">
                <i class="fas fa-fire"></i>
            </div>
            <div class="stat-value" id="activePromotions">12</div>
            <div class="stat-label">Promoções Ativas</div>
        </div>
        <div class="stat-card">
            <div class="stat-icon" style="background: var(--vivo-orange);">
                <i class="fas fa-clock"></i>
            </div>
            <div class="stat-value" id="pendingPromotions">5</div>
            <div class="stat-label">Aguardando Aprovação</div>
        </div>
        <div class="stat-card">
            <div class="stat-icon" style="background: var(--vivo-blue);">
                <i class="fas fa-chart-line"></i>
            </div>
            <div class="stat-value" id="conversionRate">78%</div>
            <div class="stat-label">Taxa de Conversão</div>
        </div>
    </div>

    <!-- SEÇÃO DE PROMOÇÕES -->
    <div class="promotions-section">
        <div class="section-header">
            <h2 class="section-title">
                <i class="fas fa-list"></i>
                Lista de Promoções
            </h2>
            <button class="add-btn" onclick="createPromotion()">
                <i class="fas fa-plus"></i>
                Nova Promoção
            </button>
        </div>

        <!-- FILTROS -->
        <div class="filters">
            <input type="text" class="search-input" placeholder="Buscar promoções por título, empresa..." id="searchInput">
            <select class="filter-select" id="statusFilter">
                <option value="">Todos os status</option>
                <option value="ativa">Ativas</option>
                <option value="pendente">Pendentes</option>
                <option value="expirada">Expiradas</option>
            </select>
            <select class="filter-select" id="categoryFilter">
                <option value="">Todas as categorias</option>
                <option value="alimentacao">Alimentação</option>
                <option value="moda">Moda</option>
                <option value="eletrônicos">Eletrônicos</option>
                <option value="saude">Saúde</option>
            </select>
        </div>

        <!-- GRID DE PROMOÇÕES -->
        <div class="promotions-grid" id="promotionsGrid">
            <!-- Dados serão carregados via JavaScript -->
        </div>
    </div>
</div>

<script>
// Dados de exemplo das promoções
const promotionsData = [
    { 
        id: 1, 
        title: 'Black Friday - 50% OFF', 
        company: 'TechStore', 
        discount: 50, 
        startDate: '2026-01-15', 
        endDate: '2026-02-15', 
        status: 'ativa',
        category: 'eletrônicos'
    },
    { 
        id: 2, 
        title: 'Desconto Especial Clientes VIP', 
        company: 'Fashion Store', 
        discount: 30, 
        startDate: '2026-01-10', 
        endDate: '2026-03-10', 
        status: 'ativa',
        category: 'moda'
    },
    { 
        id: 3, 
        title: 'Promoção de Verão', 
        company: 'Casa & Decoração', 
        discount: 25, 
        startDate: '2026-02-01', 
        endDate: '2026-02-28', 
        status: 'pendente',
        category: 'casa'
    },
    { 
        id: 4, 
        title: 'Combo Pizza + Refrigerante', 
        company: 'Pizzaria do João', 
        discount: 20, 
        startDate: '2025-12-01', 
        endDate: '2025-12-31', 
        status: 'expirada',
        category: 'alimentacao'
    },
    { 
        id: 5, 
        title: 'Medicamentos com 15% OFF', 
        company: 'Farmácia São João', 
        discount: 15, 
        startDate: '2026-01-20', 
        endDate: '2026-04-20', 
        status: 'ativa',
        category: 'saude'
    }
];

let filteredPromotions = [...promotionsData];

// Carregamento inicial
window.addEventListener('DOMContentLoaded', function() {
    renderPromotions();
    setupFilters();
    updateStats();
});

function renderPromotions() {
    const grid = document.getElementById('promotionsGrid');
    
    if (filteredPromotions.length === 0) {
        grid.innerHTML = `
            <div class="empty-state">
                <i class="fas fa-tags"></i>
                <h3>Nenhuma promoção encontrada</h3>
                <p>Crie sua primeira promoção para começar</p>
            </div>
        `;
        return;
    }

    grid.innerHTML = filteredPromotions.map(promotion => {
        const status = getPromotionStatus(promotion);
        const statusClass = getStatusClass(status);
        const statusText = getStatusText(status);

        return `
            <div class="promotion-card">
                <div class="promotion-image">
                    <i class="fas fa-tags"></i>
                    <div class="promotion-status ${statusClass}">
                        ${statusText}
                    </div>
                </div>
                <div class="promotion-content">
                    <h3 class="promotion-title">${promotion.title}</h3>
                    <div class="promotion-company">
                        <i class="fas fa-building"></i>
                        ${promotion.company}
                    </div>
                    <div class="promotion-details">
                        <div class="promotion-discount">
                            -${promotion.discount}%
                        </div>
                        <div class="promotion-dates">
                            <div><strong>Início:</strong> ${formatDate(promotion.startDate)}</div>
                            <div><strong>Expira:</strong> ${formatDate(promotion.endDate)}</div>
                        </div>
                    </div>
                    <div class="promotion-actions">
                        <button class="action-btn btn-edit" onclick="editPromotion(${promotion.id})" title="Editar">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="action-btn btn-toggle" onclick="togglePromotion(${promotion.id})" title="Ativar/Desativar">
                            <i class="fas fa-toggle-${status === 'ativa' ? 'on' : 'off'}"></i>
                        </button>
                        <button class="action-btn btn-delete" onclick="deletePromotion(${promotion.id})" title="Excluir">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </div>
            </div>
        `;
    }).join('');
}

function setupFilters() {
    const searchInput = document.getElementById('searchInput');
    const statusFilter = document.getElementById('statusFilter');
    const categoryFilter = document.getElementById('categoryFilter');

    [searchInput, statusFilter, categoryFilter].forEach(element => {
        element.addEventListener('input', filterPromotions);
    });
}

function filterPromotions() {
    const searchTerm = document.getElementById('searchInput').value.toLowerCase();
    const statusFilter = document.getElementById('statusFilter').value;
    const categoryFilter = document.getElementById('categoryFilter').value;

    filteredPromotions = promotionsData.filter(promotion => {
        const matchesSearch = promotion.title.toLowerCase().includes(searchTerm) || 
                             promotion.company.toLowerCase().includes(searchTerm);
        const matchesStatus = !statusFilter || getPromotionStatus(promotion) === statusFilter;
        const matchesCategory = !categoryFilter || promotion.category === categoryFilter;

        return matchesSearch && matchesStatus && matchesCategory;
    });

    renderPromotions();
}

function updateStats() {
    const total = promotionsData.length;
    const active = promotionsData.filter(p => getPromotionStatus(p) === 'ativa').length;
    const pending = promotionsData.filter(p => getPromotionStatus(p) === 'pendente').length;

    document.getElementById('totalPromotions').textContent = total;
    document.getElementById('activePromotions').textContent = active;
    document.getElementById('pendingPromotions').textContent = pending;
}

function getPromotionStatus(promotion) {
    const now = new Date();
    const startDate = new Date(promotion.startDate);
    const endDate = new Date(promotion.endDate);

    if (now < startDate) return 'pendente';
    if (now > endDate) return 'expirada';
    return promotion.status;
}

function getStatusClass(status) {
    const statusMap = {
        'ativa': 'status-active',
        'pendente': 'status-pending',
        'expirada': 'status-expired'
    };
    return statusMap[status] || 'status-expired';
}

function getStatusText(status) {
    const statusMap = {
        'ativa': 'Ativa',
        'pendente': 'Pendente', 
        'expirada': 'Expirada'
    };
    return statusMap[status] || 'Desconhecido';
}

function formatDate(dateString) {
    const date = new Date(dateString);
    return date.toLocaleDateString('pt-BR');
}

function createPromotion() {
    alert('Criar nova promoção - Funcionalidade em desenvolvimento');
}

function editPromotion(id) {
    alert(`Editar promoção ID: ${id}`);
}

function togglePromotion(id) {
    const promotion = promotionsData.find(p => p.id === id);
    if (promotion) {
        promotion.status = promotion.status === 'ativa' ? 'inativa' : 'ativa';
        renderPromotions();
        updateStats();
        alert(`Promoção ${promotion.status === 'ativa' ? 'ativada' : 'desativada'} com sucesso!`);
    }
}

function deletePromotion(id) {
    if (confirm('Tem certeza que deseja excluir esta promoção?')) {
        const index = promotionsData.findIndex(p => p.id === id);
        if (index > -1) {
            promotionsData.splice(index, 1);
            filterPromotions();
            updateStats();
            alert('Promoção excluída com sucesso!');
        }
    }
}
</script>
</body>
</html>

